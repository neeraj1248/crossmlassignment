<!doctype html>
{% load static %}
<html lang="en">
  <head>
        <link rel="stylesheet" href="https://cdn.datatables.net/1.10.12/css/jquery.dataTables.min.css" />
        <link rel="stylesheet" href="https://cdn.datatables.net/buttons/1.2.1/css/buttons.dataTables.min.css" />
        <script src="https://code.jquery.com/jquery-1.12.3.js" type="text/javascript"></script>
        <script src="https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min.js" type="text/javascript"></script>
        <script src="https://cdn.datatables.net/buttons/1.2.1/js/dataTables.buttons.min.js" type="text/javascript"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/2.5.0/jszip.min.js" type="text/javascript"></script>
        <script src="https://cdn.datatables.net/buttons/1.2.1/js/buttons.html5.min.js" type="text/javascript"></script> 

        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">

    {% comment %} <title>Dashboard</title> {% endcomment %}
    <style>
        td {
            text-align: center;
          }
        
        body{
            margin: 0;
            padding: 0px 10px 0px 10px;
        }
        .indiv{
            margin-top: 15px;
        }
    </style>
  </head>
  <body class="bck">
        <div class="indiv">
            <div style="display: flex;justify-content: flex-end;">            
                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">Add New Card</button>
                <a href="/logout" class="myButton logout" style="margin-left: 10px;margin-top: 5px;margin-right: 10px;text-decoration: none;" >Logout</a>
            </div>
            <p> Welcome <span style="color:red;"> {{request.user.username}} </span> </p>
        </div>
        <hr>

        <div>
            
        </div>
      <table id="example" class="display"cellspacing="0" width="100%">
        <thead>
            <tr>
                <th>Sr No</th>
                <th>Created Date</th>
                <th>Type</th>
                <th>Status</th>
                <th>Priority</th>
                <th>Assignee</th>
            </tr>
        </thead>
        <tbody>
          {% for i in card_obj %}
            <tr>
              <td>{{forloop.counter}}</td>
              <td>{{i.created_date}}</td>
              <td>{{i.get_type_display}}</td>
              <td>{{i.get_status_display}}</td>
              <td>{{i.get_priority_display}}</td>
              <td>{{i.assignee}}</td>
            </tr>
          {% endfor %}
        </tbody>
    </table>
    
    <!-- Modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Add New Card</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
            
                <form action="/add-card-data" method="POST">
                    {% csrf_token %}
                    <div class="form-row">
                        <div class="form-group col-md-6">
                            <label >Type</label>
                            <select id="" class="form-control" name="type" required>
                                <option value="">Select Type</option>
                                {% for i in type %}
                                    <option value="{{i.0}}"> {{i.1}}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="form-group col-md-6">
                            <label >Status</label>
                            <select id=""  class="form-control" name="status" required>
                                <option value="">Select Status</option>
                                {% for i in status %}
                                    <option value="{{i.0}}"> {{i.1}}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group col-md-6">
                            <label >Priority</label>
                            <select id=""   class="form-control" name="priority" required>
                                <option value="">Select Priority</option>
                                {% for i in priority %}
                                    <option value="{{i.0}}"> {{i.1}}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="form-group col-md-6">
                            <label >Assignee</label>
                            <select id=""  class="form-control" name="user" required>
                                <option value="">Select Assignee User</option>
                                {% for i in user_obj %}
                                    <option value="{{i.id}}"> {{i.username}}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                    
                  

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="submit" class="btn btn-primary">Create</button>
            </div>
        </form>
        </div>
        </div>
    </div>

    <script>
        $(document).ready(function () {
            $(document).ready(function () {
                $('table').DataTable({
                    dom: 'Blfrtip',
                    buttons: [{
                        text: 'Export To Excel',
                        extend: 'excelHtml5',
                        exportOptions: {
                            modifier: {
                                selected: true
                            },
                            columns: [0, 1, 2, 3],
                            format: {
                                header: function (data, columnIdx) {
                                    return data;
                                },
                                body: function (data, column, row) {
                                    // Strip $ from salary column to make it numeric
                                    debugger;
                                    return column === 4 ? "" : data;
                                }
                            }
                        },
                        footer: false,
                        customize: function (xlsx) {
                            var sheet = xlsx.xl.worksheets['sheet1.xml'];
                            //$('c[r=A1] t', sheet).text( 'Custom text' );
                            //$('row c[r^="C"]', sheet).attr('s', '2');
                        }
                    }]
                });
            });
        });
    </script>

    <!-- Option 1: jQuery and Bootstrap Bundle (includes Popper) -->
    {% comment %} <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script> {% endcomment %}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF" crossorigin="anonymous"></script>


  </body>
</html>
